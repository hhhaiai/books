(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{495:function(s,a,t){"use strict";t.r(a);var n=t(2),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"_1-工具篇-aidegen-android-studio"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-工具篇-aidegen-android-studio"}},[s._v("#")]),s._v(" 1. 工具篇 —— AIDEGen + Android Studio")]),s._v(" "),a("p",[s._v("AIDEGen，我叫它 “爱得跟”，大概是 Android10 中，google 推出的一个工具，用于方便开发者使用 IDE 来查看和修改系统源码。AIDEGen + Android Studio 非常适合用于阅读与修改 Android 系统 Java 代码。")]),s._v(" "),a("p",[s._v("使用 “爱得跟” 之前我们需要做一些准备工作，编译 sdk：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" build/envsetup.sh\nlunch sdk-eng\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#lunch sdk-userdebug")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#lunch sdk-user")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" sdk\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("接着我们需要去 google 官方下载 Android Studio，并将其放到 /opt 目录下。这推荐使用 3.6.3 版本，与我们的 Android10_r41 更为匹配。")]),s._v(" "),a("p",[s._v("接下来，选择我们的目标 Product：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" build/envsetup.sh\nlunch aosp_x86_64-eng  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#也可以是其他 product")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("做好以上准备工作后，我们就可以打开系统模块了，：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Settings 是系统应用 设置")]),s._v("\naidegen Settings "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" s  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -i 表示使用ide，s 表示 Android Studio")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 也可以打开一个路径，确保这个路径下有 Android.bp 或者 Android.mk 即可")]),s._v("\naidegen frameworks/base/services "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("稍作等待，Android Studio 就打开了，不过现在还不能直接使用，我们还需要做一些基本的配置:")]),s._v(" "),a("p",[s._v("Android Studio 打开后，右下角会出现一个提示框（如果没有出现，点击 file -> Invalidate Caches -> Invalidate and Restart）：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151228.png",alt:""}})]),s._v(" "),a("p",[s._v("点击 Configure，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151239.png",alt:""}})]),s._v(" "),a("p",[s._v("点击 ok 即可。")]),s._v(" "),a("p",[s._v("接着配置 jdk 和 sdk，点击 file -> Project Structure：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151246.png",alt:""}})]),s._v(" "),a("p",[s._v("接着点击 + 号：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151254.png",alt:""}})]),s._v(" "),a("p",[s._v("点击 "),a("code",[s._v("Add JDK")]),s._v("：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151305.png",alt:""}})]),s._v(" "),a("p",[s._v("选择源码下的 "),a("code",[s._v("prebuilts/jdk/jdk9/linux-x86")]),s._v(",然后点击 ok:")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151314.png",alt:""}})]),s._v(" "),a("p",[s._v("接着将 name 修改为 aosp10-jdk9，然后点击右下角 apply:")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151322.png",alt:""}})]),s._v(" "),a("p",[s._v("接着点击 + 号，添加 Android SDK：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151333.png",alt:""}})]),s._v(" "),a("p",[s._v("选择系统源码目录下的 "),a("code",[s._v("out/host/linux-x86/sdk/sdk/android-sdk_eng.zzh0838_linux-x86")]),s._v(" (最后一个文件夹的名字和你的用户名相关，你的和我的可能不一样)，然后点击 ok：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151342.png",alt:""}})]),s._v(" "),a("p",[s._v("接着 Java SDK 选择刚刚添加的 aosp10-jdk9，点击 ok：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151351.png",alt:""}})]),s._v(" "),a("p",[s._v("接着，修改 skd 的名字为 aosp10-android-sdk29:")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151358.png",alt:""}})]),s._v(" "),a("p",[s._v("点击 ok 即可。")]),s._v(" "),a("p",[s._v("接着我们需要配置项目的 sdk，点击 file -> Project Structure，点击左侧 Project，右侧 SDK 选项选择 aosp10-android-sdk：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151406.png",alt:""}})]),s._v(" "),a("p",[s._v("点击左侧 Modules，中间选择 Settings，右侧 Module SDK 选择 Project SDK：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151413.png",alt:""}})]),s._v(" "),a("p",[s._v("接着，中间选择 dependencies-Settings，右侧 Module SDK 选择 Project SDK：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151423.png",alt:""}})]),s._v(" "),a("p",[s._v("最后点击 apply，项目开始重新索引，项目内绝大部分类方法变量均可正确跳转。")]),s._v(" "),a("p",[s._v("至此，配置完成。")]),s._v(" "),a("h2",{attrs:{id:"_2-手段篇-java-源码的阅读"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-手段篇-java-源码的阅读"}},[s._v("#")]),s._v(" 2. 手段篇 —— Java 源码的阅读")]),s._v(" "),a("p",[s._v("Java 源码我们一般通过以下两种方法阅读：")]),s._v(" "),a("ol",[a("li",[s._v("Log + 打印调用栈")]),s._v(" "),a("li",[s._v("AIDEGen + Android Studio + 断点调试")])]),s._v(" "),a("p",[s._v("针对启动相关的源码，一般是使用第一种方法阅读，接下来我们来看看如何阅读系统启动过程中的重要进程 SystemServer：")]),s._v(" "),a("p",[s._v("首先找到 SystemServer：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#源码根目录下")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" frameworks\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SystemServer*"')]),s._v("\n./base/cmds/svc/src/com/android/commands/svc/SystemServerCommand.java\n./base/services/java/com/android/server/SystemServer.java\n./base/services/core/java/com/android/server/SystemServerInitThreadPool.java\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# aidengen 打开")]),s._v("\naidegen frameworks/base/services\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("在 Android Studio 中我们打开 SystemServer.java，找到 main 方法，并添加下面的代码：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//通过打印 log 了解程序的运行状况")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("d")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yuandaima"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SystemServer is starting"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//通过打印堆栈了解方法的调用路径")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printStackTrace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("currentThread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SystemServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//打印调用堆栈的方法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printStackTrace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),s._v(" thread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StackTraceElement")]),s._v(" e "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" thread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getStackTrace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("d")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yuandaima"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("p",[s._v("接着我们编译系统，开启模拟器，然后获取日志信息：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("rice14:/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# logcat | grep "yuandaima"')]),s._v("\n05-10 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":37:04.719  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v(" D yuandaima: SystemServer is starting\n05-10 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":37:04.720  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v(" D yuandaima: dalvik.system.VMStack.getThreadStackTrace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Native Method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n05-10 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":37:04.721  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v(" D yuandaima: java.lang.Thread.getStackTrace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Thread.java:1720"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n05-10 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":37:04.721  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v(" D yuandaima: com.android.server.SystemServer.printStackTrace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SystemServer.java:350"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n05-10 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":37:04.721  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v(" D yuandaima: com.android.server.SystemServer.main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SystemServer.java:362"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n05-10 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":37:04.721  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v(" D yuandaima: java.lang.reflect.Method.invoke"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Native Method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n05-10 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":37:04.721  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v(" D yuandaima: com.android.internal.os.RuntimeInit"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MethodAndArgsCaller")]),s._v(".run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("RuntimeInit.java:492"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n05-10 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":37:04.721  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1641")]),s._v(" D yuandaima: com.android.internal.os.ZygoteInit.main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ZygoteInit.java:908"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("通过打日志我们可以了解系统程序的运行状况以及一些关键参数，通过调用堆栈我们可以了解程序运行过程中方法的一个调用流程。")]),s._v(" "),a("p",[s._v("非启动相关的源码，通常结合两种方法来阅读。接下来我们看看如何断点调试系统 App：")]),s._v(" "),a("p",[s._v("首先，我们开一个新的终端，打开模拟器：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" build/envsetup.sh\nlunch aosp_x86_64-eng\nemulator\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("接着我们在 Settings/AndroidManifest.xml 查找到 Settings App 的首 Activity 为 SettingsHomepageActivity，我们在其 onCreate 出打一个断点：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151440.png",alt:""}})]),s._v(" "),a("p",[s._v("接着在 Android 模拟器中打开 Settings 应用。")]),s._v(" "),a("p",[s._v("接着点击 android studio 的 debug 按钮：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151448.png",alt:""}})]),s._v(" "),a("p",[s._v("在弹出的窗口中，依次选择 Settings 和 com.android.settings,然后点击 ok：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151457.png",alt:""}})]),s._v(" "),a("p",[s._v("在模拟器中，点击返回键，再次进入 Settings 应用，即可进入调试界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230719151504.png",alt:""}})]),s._v(" "),a("p",[s._v("接着我们就可以顺利的进行调试了。")]),s._v(" "),a("h2",{attrs:{id:"关于"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于"}},[s._v("#")]),s._v(" 关于")]),s._v(" "),a("p",[s._v("我叫阿豪，2015 年本科毕业于国防科学技术大学指挥信息系统专业，毕业后从事信息化装备的研发工作，主要研究方向是 Android Framework 与 Linux Kernel。")]),s._v(" "),a("p",[s._v("如果你对 Android Framework 感兴趣或者正在学习 Android Framework，可以关注我的微信公众号和抖音，我会持续分享我的学习经验，帮助正在学习的你少走一些弯路。学习过程中如果你有疑问或者你的经验想要分享给大家可以添加我的微信，我拉你进技术交流群。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/%E4%BA%8C%E7%BB%B4%E7%A0%81.jpg",alt:""}})])])}),[],!1,null,null,null);a.default=e.exports}}]);